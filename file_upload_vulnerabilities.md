# File Upload Vulnerabilities

**–¶–µ–ª—å:** –ü–æ–Ω—è—Ç—å, –∫–∞–∫ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∏ –º–æ–≥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ —Ñ–∞–π–ª—ã, –ø–æ–ª—É—á–∞—Ç—å —É–¥–∞–ª—ë–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø (RCE) –∏–ª–∏ –æ–±—Ö–æ–¥–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é.

–§–æ–∫—É—Å: –∑–∞–≥—Ä—É–∑–∫–∞ web shell, —É—è–∑–≤–∏–º–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ Content-Type –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π, –ø—É—Ç–∏ –æ–±—Ö–æ–¥–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏.

---

## üìö –ß—Ç–æ —Ç–∞–∫–æ–µ File Upload Vulnerabilities

–£—è–∑–≤–∏–º–æ—Å—Ç–∏ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤ –≤–æ–∑–Ω–∏–∫–∞—é—Ç, –∫–æ–≥–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–≥—Ä—É–∑–∫—É —Ñ–∞–π–ª–æ–≤ –±–µ–∑ –¥–æ–ª–∂–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–∏–ø–∞, —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è –∏–ª–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è.  
–≠—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫:
- –í—ã–ø–æ–ª–Ω–µ–Ω–∏—é –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞ (RCE),
- –û–±—Ö–æ–¥—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏,
- –ó–∞—Ö–≤–∞—Ç—É —Å–µ—Ä–≤–µ—Ä–∞ —á–µ—Ä–µ–∑ web shell.

---

## üîç –û—Å–Ω–æ–≤–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã –∞—Ç–∞–∫

- **Unrestricted file upload** ‚Äî –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è/—Ç–∏–ø–∞ —Ñ–∞–π–ª–∞
- **Flawed extension validation** ‚Äî –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ (–º–æ–∂–Ω–æ –æ–±–æ–π—Ç–∏ —Å `file.php.jpg`)
- **Flawed MIME-type validation** ‚Äî –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è `Content-Type`, –Ω–æ –Ω–µ —Å–∞–º–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
- **Web shell execution** ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, PHP) —Å –ø–æ—Å–ª–µ–¥—É—é—â–∏–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º
- **Bypass via double extensions** ‚Äî `file.php.png`, `file.phtml`, `file.php;.jpg`
- **Upload to accessible folder** ‚Äî —Ñ–∞–π–ª —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ø–∞–ø–∫–µ, –æ—Ç–∫—É–¥–∞ –º–æ–∂–Ω–æ –µ–≥–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å

---

## ‚úÖ –ü—Ä–æ–π–¥–µ–Ω–æ (–≤–µ—Å—å –±–ª–æ–∫ File Upload Vulnerabilities)

- üìñ What are file upload vulnerabilities?
- üîç How do file upload vulnerabilities arise?
- üêö Exploiting unrestricted file uploads to deploy a web shell
- üß™ Exploiting flawed validation of file uploads
- üì¶ Flawed file type validation
- ‚öîÔ∏è Lab: Remote code execution via web shell upload
- üõ°Ô∏è Lab: Web shell upload via Content-Type restriction bypass

---

## üí° –ß—Ç–æ —è —É–∑–Ω–∞–ª

- –î–∞–∂–µ –µ—Å–ª–∏ –∑–∞–ø—Ä–µ—â–µ–Ω–æ `.php`, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `Content-Type` –∏–ª–∏ –¥–≤–æ–π–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –¥–ª—è –æ–±—Ö–æ–¥–∞.
- Web shell (`<?php system($_GET["cmd"]); ?>`) ‚Äî –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è RCE.
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å **–ø–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É**, –∞ –Ω–µ –ø–æ MIME –∏–ª–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é.
- –ó–∞–≥—Ä—É–∑–∫–∞ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é, –¥–æ—Å—Ç—É–ø–Ω—É—é –∏–∑–≤–Ω–µ ‚Äî –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è —É–≥—Ä–æ–∑–∞.

---

## üîß Burp Suite (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–æ—Å—å)

- –û—Ç—Å–ª–µ–∂–∏–≤–∞–ª `POST`-–∑–∞–ø—Ä–æ—Å—ã —Å —Ñ–∞–π–ª–∞–º–∏
- –ú–µ–Ω—è–ª `Content-Type` –≤—Ä—É—á–Ω—É—é (–Ω–∞ `image/jpeg` ‚Üí `application/x-php`)
- –ü–µ—Ä–µ—Ö–æ–¥–∏–ª –ø–æ URL –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–¥–∞
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª Repeater –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∏ –ø–æ–≤—Ç–æ—Ä–∞ –∑–∞–≥—Ä—É–∑–∫–∏

